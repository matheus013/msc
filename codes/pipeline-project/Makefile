###############################################################################
# ğŸ“¦ Makefile â€“ Demand Forecast Pipeline
# ---------------------------------------------------------------------------
# Comandos bÃ¡sicos para desenvolvimento e execuÃ§Ã£o do projeto Kedro
###############################################################################

PROJECT_NAME := demand_forecast_pipeline
PYTHON       ?= python3
VENV         ?= .venv

.DEFAULT_GOAL := help

## ğŸ› ï¸ Criar ambiente virtual e instalar dependÃªncias
install:
	@echo "ğŸ“¦ Criando ambiente virtual..."
	$(PYTHON) -m venv $(VENV)
	@echo "ğŸ“¦ Instalando dependÃªncias..."
	$(VENV)/bin/pip install --upgrade pip
	$(VENV)/bin/pip install -r requirements.txt

## â–¶ï¸ Executar pipeline completo
run:
	@echo "ğŸš€ Executando pipeline Kedro..."
	$(VENV)/bin/kedro run

## â–¶ï¸ Executar pipeline por tag
run-tag:
	@read -p "Digite a tag: " tag; \
	$(VENV)/bin/kedro run --tag $$tag

## ğŸ§ª Executar testes
test:
	@echo "ğŸ§ª Rodando testes..."
	$(VENV)/bin/pytest -q

## ğŸ§¹ Limpar arquivos temporÃ¡rios
clean:
	@echo "ğŸ§¹ Limpando cache e arquivos temporÃ¡rios..."
	rm -rf .pytest_cache
	rm -rf $(VENV)
	find . -type d -name "__pycache__" -exec rm -rf {} +

## ğŸ“œ Mostrar ajuda
help:
	@echo "Comandos disponÃ­veis:"
	@grep -E '^[a-zA-Z_-]+:.*?##' $(MAKEFILE_LIST) | \
		sed 's/:.*##/ â†’/' | sort
